(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6398],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return s},kt:function(){return f}});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),u=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},s=function(e){var t=u(e.components);return r.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),d=u(n),f=a,h=d["".concat(l,".").concat(f)]||d[f]||p[f]||i;return n?r.createElement(h,o(o({ref:t},s),{},{components:n})):r.createElement(h,o({ref:t},s))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=d;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:a,o[1]=c;for(var u=2;u<i;u++)o[u]=n[u];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},93545:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return c},contentTitle:function(){return l},metadata:function(){return u},toc:function(){return s},default:function(){return d}});var r=n(22122),a=n(19756),i=(n(67294),n(3905)),o=["components"],c={id:"backup",title:"Backup",sidebar_label:"Backup"},l=void 0,u={unversionedId:"reference-guide/backup",id:"reference-guide/backup",isDocsHomePage:!1,title:"Backup",description:"While running, Memgraph generates a couple of different files in its data",source:"@site/docs/reference-guide/backup.md",sourceDirName:"reference-guide",slug:"/reference-guide/backup",permalink:"/memgraph/next/reference-guide/backup",editUrl:"https://github.com/memgraph/docs/tree/master/docs/reference-guide/backup.md",version:"current",frontMatter:{id:"backup",title:"Backup",sidebar_label:"Backup"},sidebar:"memgraph",previous:{title:"Overview",permalink:"/memgraph/next/database-functionalities"},next:{title:"Existence constraint",permalink:"/memgraph/next/database-functionalities/constraints/existence-constraint"}},s=[{value:"Creating a snapshot",id:"creating-a-snapshot",children:[]}],p={toc:s};function d(e){var t=e.components,n=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"While running, Memgraph generates a couple of different files in its data\ndirectory. The directory includes multiple different subdirectories, one of\nthem being the storage directory which contains the durability files. In that\ndirectory, Memgraph periodically generates snapshots and WAL files that\ncontain Memgraph's data in a recoverable format."),(0,i.kt)("p",null,"Making a backup of a Memgraph instance would consist of simply copying the\ndata directory. This is impossible without additional help because\nthe durability files can be deleted when an event is triggered\n(the number of snapshots exceeded the maximum allowed number)."),(0,i.kt)("p",null,"To disable this behavior, you can use the following query:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-opencypher"},"LOCK DATA DIRECTORY;\n")),(0,i.kt)("p",null,"Now, the deletion of every file contained in the data directory is delayed\nuntil you unlock it again. You can safely copy the data directory or\na single snapshot to another location without worrying that it will be\ndeleted during that process."),(0,i.kt)("p",null,"To allow the deletion of the files, run the following query:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-opencypher"},"UNLOCK DATA DIRECTORY;\n")),(0,i.kt)("p",null,"Memgraph will delete the files which should have been deleted before\nand allow any future deletion of the files contained in the data\ndirectory."),(0,i.kt)("h3",{id:"creating-a-snapshot"},"Creating a snapshot"),(0,i.kt)("p",null,"Snapshot is created periodically based on the time defined with the\n",(0,i.kt)("inlineCode",{parentName:"p"},"--storage-snapshot-interval-sec")," config. If you want to generate a snapshot\ninstantly for the current database state, you can use the following query:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-opencypher"},"CREATE SNAPSHOT;\n")))}d.isMDXComponent=!0}}]);